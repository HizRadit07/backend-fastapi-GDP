
# My-Backend-FastAPI-API
This README is made by using readme.so

This is the source code for my personal backend API part of a lowcode exploration project for my internship at GDP Labs.
The aim of this API is to explore and familiarize me with technologies such as FastAPI, Firebase, and Airtable with their respective data managing functionalities.


# Description
This project is an API made with FastAPI in order to manage data stored in Airtable and Firebase Firestore. The basic premise of this project
is to create a sample personal profile page with similar design to linkedin. A prerequisite for this API is to understand Airtable and Firebase Firestore as these are the 2 main platforms
from which the data will be stored.

When used, this API will provide endpoints from which one can do Create, Read, Update, or Delete data (CRUD). Because 
this API is made using FastAPI, FastAPI provides instant easy documentation that can be accessed when the backend is run.

One can open the documentation by using the /docs endpoint.

Some of the routes for this API is blocked by authentication which requires one to sign in using firebase authentication. 
For more information, one can check this page https://firebase.google.com/docs/reference/rest/auth?hl=en#section-sign-in-email-password. 
Basically, it prompts one to sign in to a specific URL using a specific project API key (making sure the project has been initialized on firebase)
in order to get an id-token which can be added to the header of requests requiring id-token headers with the endpoints provided by this API (see API reference below).

## Setup Airtable

1. Go to www.airtable.com, create an account
2. Create a new base, this is the main work area for airtable
3. Create 3 separate table in a base with the names User, About, and Experience with the following fields

note: each table and field name is case sensitive

- User: an instance of a User
    - Name : formula : full name of the user, uses airtable formula data type (can be equated to either number / string), concatenation of the attribute "First Name" and "Last Name"
    - First Name : string : First name of the user
    - Last Name : string : Last name of the user
    - About : array of record IDs (string): refer to description(s) about a particular user
    - Experience : array of record IDs (string): refer to experience(s) owned by a particular user

- About: an instance of about / description of a user
    - About ID: Auto Number : an automatically incremented unique counter for the instance
    - Description : string : description for a user
    - User : array of record IDs (string) : refer to user(s) who own this particular description (ideally only 1)

- Experience: an instance of experience owned by a particular user (one user can have many experiences)
    - Experience ID : formula : concatenation of "Job Title" and "Company Name"
    - User : array of record IDs (string) : refer to user(s) who own this particular experience
    - Company Name : string : name of the Company
    - Company Logo : array of attachment objects : an array of image objects, for more information see https://support.airtable.com/hc/en-us/articles/360007852173-Attachment-field
    - Job Title : string : title of the Job
    - Job Type : string : has 3 specific values, either Internship, Full time, or Part time
    - Date Start : string : ISO 8601 formatted Date
    - Date End : string : ISO 8601 formatted Date
    - Location : string : location of the employment / experience
    - Description : string : description for the employment / experience

4. You can find a simple documentation for airtable CRUD services for your base by opening the link www.airtable.com/api
5. from www.airtable.com/api you can find the environment variable AIRTABLE_BASE_ID
6. You can get the environment variable AIRTABLE_API_KEY from your airtable profile
7. There is a public version of the airtable database used for this project, the link is as follow:
https://airtable.com/shrIx3PDlu4HI6vYo (feel free to copy and use this base)


## Setup Firebase Firestore
1. Create a google account, go to firebase.google.com, go to console
2. Create a new firebase project
3. Create a new firebase firestore database
4. Create a database with 3 collections User, Experience, and About with the following fields

note: all table and field names are case sensitive

- User: an instance of a User
    - Name : string : full name of the user
    - First Name : string : First name of the user
    - Last Name : string : Last name of the user
    - user_id : string : unique id for the user (auto generated by firebase)

- About: an instance of about / description of a user
    - Description : string : description of a user
    - User : string : id referring to a particular user

- Experience: an instance of experience owned by a user
    - Company Logo : string : url to stored image
    - Company Name : string : name of the company
    - Date End : string : date with format Month date, year (August 5, 2022)
    - Date Start : string : date with format Month date, year (August 5, 2022)
    - Description : string : description of the experience / employment
    - Job Title : string : title of the Job
    - Job Type : string : has 3 specific values, either Internship, Full time, or Part time
    - Location : string : location of the employment
    - User : string : id referring to a particular user

5. To get firebase credentials, on your firebase project, go to project settings -> service account -> firebase admin
6. There should be a button to generate your credentials
7. After you receive your credential (in the form of a json file), you can insert your values into the environment variable
8. If you are still having difficulties, you can open the file src/firebase.py and change the following line with your credentials
```bash
  cert = {
    "type": "service_account",
    "project_id": os.environ.get("FIREBASE_PROJECT_ID"),
    "private_key_id": "83f66b2d3c0bc913f18f35ba5ba0fe64ba78c0d0",
    "private_key": os.environ.get("FIREBASE_PRIVATE_KEY").replace('\\n', '\n'),
    "client_email": os.environ.get("FIREBASE_CLIENT_EMAIL"),
    "client_id": "106555114812167066499",
    "auth_uri": "https://accounts.google.com/o/oauth2/auth",
    "token_uri": "https://oauth2.googleapis.com/token",
    "auth_provider_x509_cert_url": "https://www.googleapis.com/oauth2/v1/certs",
    "client_x509_cert_url": "https://www.googleapis.com/robot/v1/metadata/x509/firebase-adminsdk-hxjaz%40test-firebase-6fa94.iam.gserviceaccount.com"
  }
```
## Run Locally

Clone the project

```bash
  git clone https://link-to-project
```

Go to the project directory

```bash
  cd my-project
```

Create .env file and enter your credentials
```bash
  .env.example explanation

  the following can be found on www.airtable.com/api, corresponding to your base and api key

  AIRTABLE_BASE_ID='appPucj1FvmbK3LL4' base id for your airtable base
  AIRTABLE_API_KEY='YOUR_API_KEY' your personal airtable api key
  PORT='' port to run the server locally

  the following can be found on your firebase project -> project settings -> service account -> firebase admin sdk

  FIREBASE_PRIVATE_KEY='' a private key for firebase configuration
  FIREBASE_CLIENT_EMAIL='' client email for firebase configuration
  FIREBASE_PROJECT_ID='' project id for firebase configuration
```


Start python virtual environment

```bash
  source bin/activate (for mac / linux)

  .\Scripts\activate (for windows)
```

Install requirements

```bash
  pip install -r requirements.txt
```

Run the server

```bash
  uvicorn src.app:app --reload --port 3000
```
## Deployed Version

The following is recommended rather than running locally

This project also offers a deployed version of the API which can be accessed by anyone, the link can be found below

https://my-fastapi-airtable.herokuapp.com/

API endpoints documentation:

https://my-fastapi-airtable.herokuapp.com/docs
## API Reference

### User Endpoints

#### Get User by ID

```http
  GET /user/id/{user_id}
```

| Parameter | Type     | Description                |
| :-------- | :------- | :------------------------- |
| `user_id` | `string` | **Required**. id of the user |

#### Get User by Name

```http
  GET /user/name/{user_name}
```

| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `user_name`      | `string` | **Required**. Name of the user to fetch |

#### Update User By ID

```http
  PATCH /user/{user_id}
```

| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `user_id`      | `string` | **Required**. id of the user |
| request body | `json` | { "first_name": "string", "last_name": "string"} |

#### Firebase Get User by ID

```http
  GET /firebase/user/id/{user_id}
```

| Parameter | Type     | Description                |
| :-------- | :------- | :------------------------- |
| `user_id` | `string` | **Required**. id of the user |

#### Firebase Get User by Name

```http
  GET /firebase/user/name/{user_name}
```

| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `user_name`      | `string` | **Required**. Name of the user to fetch |

#### Firebase Update User By ID

```http
  PATCH /firebase/user/{user_id}
```

| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `user_id`      | `string` | **Required**. id of the user |
| `id-token` (header)      | `string` | **Required**. id-token for authentication |
| request body | `json` | { "first_name": "string", "last_name": "string"} |


### About Endpoints

#### Get About by User Name

```http
  GET /about/{user_name}
```

| Parameter | Type     | Description                |
| :-------- | :------- | :------------------------- |
| `user_name` | `string` | **Required**. name of the user described |

#### Update About By ID

```http
  PATCH /about/{about_id}
```

| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `about_id`      | `string` | **Required**. id of the specific description |
| request body | `json` | { "description": "string"} |

#### Firebase Get About by User ID

```http
  GET /firebase/about/{user_id}
```

| Parameter | Type     | Description                |
| :-------- | :------- | :------------------------- |
| `user_id` | `string` | **Required**. id of the user who owned the description |

#### Firebase Update About By ID

```http
  PATCH /firebase/about/{about_id}
```

| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `about_id`      | `string` | **Required**. id of the specific description |
| `id-token` (header)      | `string` | **Required**. id-token for authentication |
| request body | `json` | { "description": "string"}  |


### Experience Endpoints

#### Get Experience by User Name

```http
  GET /experience/{user_name}
```

| Parameter | Type     | Description                |
| :-------- | :------- | :------------------------- |
| `user_name` | `string` | **Required**. name of user who owns 1 or more experience |

#### Delete Experience by Experience ID

```http
  DELETE /experience/{experience_id}
```

| Parameter | Type     | Description                |
| :-------- | :------- | :------------------------- |
| `experience_id` | `string` | **Required**. id of a experience to be deleted|

#### Update Experience by Experience ID

```http
  PATCH /experience/{experience_id}
```

| Parameter | Type     | Description                |
| :-------- | :------- | :------------------------- |
| `experience_id` | `string` | **Required**. id of a experience to be updated|
| request body | `json` | example:  {"company_name": "GDP Labs", "job_title": "Software Engineering Intern","job_type": "internship","date_start": "2022-06-02","date_end": "2022-08-05","location": "Indonesia","description": "I worked here","company_logo_url": "https://picsum.photos/200"} |


#### Create Experience for User

```http
  POST /experience/{user_id}
```

| Parameter | Type     | Description                |
| :-------- | :------- | :------------------------- |
| `user_id` | `string` | **Required**. id of a user to create new experience|
| request body | `json` | example:  {"company_name": "GDP Labs", "job_title": "Software Engineering Intern","job_type": "internship","date_start": "2022-06-02","date_end": "2022-08-05","location": "Indonesia","description": "I worked here","company_logo_url": "https://picsum.photos/200"} |

#### Firebase Get Experience by User ID

```http
  GET firebase/experience/{user_id}
```

| Parameter | Type     | Description                |
| :-------- | :------- | :------------------------- |
| `user_id` | `string` | **Required**. id of user who owns 1 or more experience |

#### Firebase Delete Experience by Experience ID

```http
  DELETE /firebase/experience/{experience_id}
```

| Parameter | Type     | Description                |
| :-------- | :------- | :------------------------- |
| `experience_id` | `string` | **Required**. id of a experience to be deleted|
| `id-token` (header)      | `string` | **Required**. id-token for authentication |

#### Firebase Update Experience by Experience ID

```http
  PATCH /firebase/experience/{experience_id}
```

| Parameter | Type     | Description                |
| :-------- | :------- | :------------------------- |
| `experience_id` | `string` | **Required**. id of a experience to be updated|
| `id-token` (header)      | `string` | **Required**. id-token for authentication |
| request body | `json` | example:  {"company_name": "GDP Labs", "job_title": "Software Engineering Intern","job_type": "internship","date_start": "2022-06-02","date_end": "2022-08-05","location": "Indonesia","description": "I worked here","company_logo_url": "https://picsum.photos/200"} |


#### Firebase Create Experience for User

```http
  POST /firebase/experience/{user_id}
```

| Parameter | Type     | Description                |
| :-------- | :------- | :------------------------- |
| `user_id` | `string` | **Required**. id of a user to create new experience|
| `id-token` (header)      | `string` | **Required**. id-token for authentication |
| request body | `json` | example:  {"company_name": "GDP Labs", "job_title": "Software Engineering Intern","job_type": "internship","date_start": "2022-06-02","date_end": "2022-08-05","location": "Indonesia","description": "I worked here","company_logo_url": "https://picsum.photos/200"} |









